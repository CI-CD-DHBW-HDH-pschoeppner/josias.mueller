name: Deploy
on: [push]
permissions:
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./

    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v3

      - name: npm
        run: |
         npm ci
         npm run build
        working-directory: ./

      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: dist

      # - name: Deploying containers to server via SSH
      #   uses: appleboy/ssh-action@v0.1.8
      #   with:
      #     host: ${{ secrets.HOSTNAME }}
      #     username: ${{ secrets.USERNAME }}
      #     key: ${{ secrets.KEY }}
      #     port: ${{ secrets.PORT }}
      #     script:
      #       (docker stop $(docker ps -a -q)) || true;
      #       (docker rm $(docker ps -a -q)) || true;
      #       docker pull ghcr.io/ci-cd-dhbw-hdh-pschoeppner/josias.mueller/todo:latest;
      #       docker run -d -p 80:80 ghcr.io/ci-cd-dhbw-hdh-pschoeppner/josias.mueller/todo:latest;